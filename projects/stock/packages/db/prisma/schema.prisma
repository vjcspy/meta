generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model StockInfoStock {
  id             Int       @id @default(autoincrement())
  refId          Int?
  catId          Int?
  code           String    @unique() @db.VarChar(255)
  exchange       String    @db.VarChar(255)
  industryName1  String?   @db.VarChar(255)
  industryName2  String?   @db.VarChar(255)
  industryName3  String?   @db.VarChar(255)
  totalShares    BigInt
  name           String    @db.VarChar(255)
  firstTradeDate DateTime? @db.Date

  @@map("stock_info_stocks")
}

model StockInfoTick {
  id     Int      @id @default(autoincrement())
  symbol String   @db.VarChar(10)
  date   DateTime @db.Date
  meta   Json

  @@map("stock_info_ticks")
}

model StockInfoPrice {
  id                  Int      @id @default(autoincrement())
  date                DateTime @db.Date
  symbol              String   @db.VarChar(10)
  priceBasic          Int // Gia dong cua ngay hom qua, dua vao do de biet duoc % change
  priceHigh           Int
  priceLow            Int
  priceOpen           Int
  priceClose          Int
  priceAverage        Int
  volume              Int
  value               Int // 10**6
  dealVolume          Int
  buyForeignQuantity  Int
  buyForeignValue     Int // 10**6
  sellForeignQuantity Int
  sellForeignValue    Int // 10**6
  currentForeignRoom  BigInt?  @db.BigInt

  @@unique([symbol, date])
  @@map("stock_info_prices")
}

model StockTradingAnalysis {
  id     Int    @id @default(autoincrement())
  symbol String @unique @db.VarChar(10)

  trade_value_7  BigInt? @default(0) @db.BigInt
  trade_value_14 BigInt? @default(0) @db.BigInt
  trade_value_30 BigInt? @default(0) @db.BigInt

  cap BigInt? @default(0) @db.BigInt // Von Hoa

  l16_hullma_trend                Int @default(0) @db.SmallInt // hullma 16 trend, 0 not sure, 1 up, -1 down
  l16_hullma_day_in_trend         Int @default(0) @db.SmallInt // how many days in current trend?
  l16_hullma_highest_diff_percent Int @default(0) @db.SmallInt // Neu dang o downtrend, thi gia giam max tu luc up trend lan truoc la bao nhieu
  cur_gap_percent                 Int @default(0) @db.SmallInt

  foreign_buy_30  Int @default(0) @db.SmallInt
  foreign_sell_30 Int @default(0) @db.SmallInt
  foreign_diff_30 Int @default(0) @db.SmallInt

  foreign_buy_15  Int @default(0) @db.SmallInt
  foreign_sell_15 Int @default(0) @db.SmallInt
  foreign_diff_15 Int @default(0) @db.SmallInt

  foreign_buy_7  Int @default(0) @db.SmallInt
  foreign_sell_7 Int @default(0) @db.SmallInt
  foreign_diff_7 Int @default(0) @db.SmallInt

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  @@map("stock_trading_analysis")
}
